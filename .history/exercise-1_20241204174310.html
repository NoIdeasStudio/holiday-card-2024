<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>digit-al exercises</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ml5/0.10.0/ml5.min.js" async defer></script>

</head>
<body>

    <div class="wrapper">
        <header class="small-text header-1">day 0/265</header>
        <header class="small-text header-2">Digit-al Exercises for the graphic designer</header>
        <header class="small-text header-3"><a href="./info.html">Info</a></header>
       
        <!-- Preview, illustrations of the exercises -->
        <content class="large-text content-header-1">Preview</content>
                <div class="img-1"><img src="./Svgs/exercise-1-1.svg" alt="touch thumb to index" height="100%" width="100%" /></div>
                <div class="img-2"><img src="./Svgs/exercise-1-2.svg" alt="touch thumb to middle" height="100%" width="100%" /></div>
                <div class="img-3"><img src="./Svgs/exercise-1-3.svg" alt="touch thumb to ring" height="100%" width="100%" /></div>
                <div class="img-4"><img src="./Svgs/exercise-1-4.svg" alt="touch thumb to pinky" height="100%" width="100%" /></div>
        <footer class="large-text content-footer-1">10x 10x</footer>
        <footer class="large-text content-footer-2">L R</footer>

        <!-- Movement, videos of the movement -->
        <content class="large-text content-header-2"><a href="http://">Movement</a></content>
                <div class="movement-video"> </div>
        <content class="large-text content-header-3">1/5</content>



        <footer class="large-text content-footer-3">5 digits tip to tip</footer>
        <footer class="large-text content-footer-4"><a href="./exercise-2.html">Next</a></footer>

    </div>
    
</body>

<script>
  const videoElement = document.createElement('video');
  const canvasElement = document.createElement('canvas');
  const ctx = canvasElement.getContext('2d');
  const movementVideoDiv = document.querySelector('.movement-video');

  let handPoseModel;
  let hands = [];

  // Append video and canvas to the movement-video div
  movementVideoDiv.appendChild(videoElement);
  movementVideoDiv.appendChild(canvasElement);

  async function setupCamera() {
    try {
      // Set up video feed
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { width: 640, height: 480 },
        audio: false,
      });
      videoElement.srcObject = stream;
      videoElement.width = 640;
      videoElement.height = 480;
      videoElement.autoplay = true;
      return new Promise((resolve) => {
        videoElement.onloadedmetadata = () => {
          console.log("Video feed loaded!");
          resolve(videoElement);
        };
      });
    } catch (err) {
      console.error("Camera setup failed:", err);
    }
  }

  async function setup() {
    // Initialize camera
    await setupCamera();
    videoElement.play();

    // Set canvas size to match video feed
    canvasElement.width = videoElement.videoWidth;
    canvasElement.height = videoElement.videoHeight;

    // Load Handpose model
    handPoseModel = await ml5.handpose(videoElement, () => {
      console.log("Handpose model loaded!");
    });

    // Add predict listener
    handPoseModel.on('predict', (results) => {
      console.log("Predictions:", results); // Debug: Log predictions
      hands = results;
    });

    // Start rendering loop
    draw();
  }

  function draw() {
    // Clear the canvas
    ctx.clearRect(0, 0, canvasElement.width, canvasElement.height);

    // Draw video feed
    ctx.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);

    // Draw hand predictions
    if (hands.length > 0) {
      hands.forEach((hand) => {
        const landmarks = hand.annotations;

        // Draw landmarks
        for (let key in landmarks) {
          landmarks[key].forEach(([x, y]) => {
            ctx.beginPath();
            ctx.arc(x, y, 5, 0, Math.PI * 2);
            ctx.fillStyle = 'red';
            ctx.fill();
          });
        }
      });
    }

    // Continue rendering
    requestAnimationFrame(draw);
  }

  // Initialize the application
  setup();
</script>




<!-- <script src="./p5.min.js" async defer></script>
<script src="https://unpkg.com/ml5@1/dist/ml5.js" async defer></script>
<script src="./sketch.js" async defer></script> -->

</html>